<html>
<head>
<style type='text/css'>
textarea.content {
width:100%;
height:150px;
}
input.summary {
width:100%;
font-size:130%;
}
iframe.rndr {
width:100%;
height:300px;
}
.msg {
font-weight:bold;
color:red;
}
.ralign {
text-align:right;
}
table.taskslist {
width:100%;
}
.taskslist th {
background-color:#abc;
}
.sumcln {
width:30%;
}
.tagcln {
width:10%;
}
.odd {
background-color:#ddd;
}
.search {
float:right;
}
</style>
</head>
<body>
  <a accesskey="h" href="${upr}/"><b>h</b>ome</a> :: \
  <a accesskey="i" href="${upr}/iterations"><b>i</b>terations list</a> :: \
  <a accesskey="p" href="${upr}/participants"><b>p</b>articipants</a> :: \
  <a accesskey="n" href="${upr}/s/new"><b>n</b>ew task</a> :: \
  <form class='search' method='get' action='${upr}/search'>
    <input type='text' name='q' value="" />
    <input type='submit' value='Search' />
  </form>
  ${self.content()}
</body>
</html>
<%def name="list_tasks(tasks,header=True,body=True,footer=True,cnt={'cnt':0})">
% if header:
<table class='taskslist'>
<thead>
  <tr>
    <th>iteration</th>
    <th>id</th>
    <th>status</th>
    <th>assignee</th>    
    <th>tags</th>
    <th>parents</th>
    <th>summary</th>
  </tr>
</thead>
<tbody>
% endif
% if body:
% for t in tasks:
<%
if 'priority' in t['tags']:
  pritag='<b>'
  prietag='</b>'
else:
  pritag=''
  prietag=''
%>
<tr \
% if cnt['cnt'] %2 ==0:
class='odd'
% endif
>
  <td><a href="${upr}/iteration/${t['iteration']}">${t['iteration']}</a></td>
  <td>
${pritag}<a href="${upr}/s/${t['story']}" title="${t['summary']|h}">${t['story']}</a>${prietag}</td>
  <td>${t['status']}</td>
  <td><a href="${upr}/assignments/${t['assigned to']}">${t['assigned to']}</a></td>
  <td class='tagcln'>${', '.join(t['tags'])}</td>
  <td style='text-align:right'>
<% mlen = 30 %>
% if t.get('pdescrs'):
% for pid,psum in t['pdescrs']:
<a title="${psum}" href="${upr}/s/${pid}">${(len(psum)<=mlen and psum or (psum[0:mlen]+'..'))}</a> &#8250;
% endfor
% endif
</td>
  <td class='sumcln' title="${t['summary']|h}">${pritag}${len(t['summary'])<40 and t['summary'] or t['summary'][0:40]+'..'}${prietag}</td>
</tr>
<% cnt['cnt']+=1 %>
% endfor
% endif
% if footer:
</tbody>
</table>
% endif
</%def>
